# Finance Papers - Quick Reference

## Installation

```bash
pip install -e .
```

## Commands

### Main Workflow
```bash
finance-papers              # Run complete workflow (incremental)
finance-papers --force      # Run complete workflow (all years)
```

### Fetch Journal Articles
```bash
get-papers jf 2024          # Fetch Journal of Finance 2024
get-papers rfs 2024         # Fetch Review of Financial Studies 2024
get-papers jfe 2024         # Fetch Journal of Financial Economics 2024
get-papers top3 2024        # Fetch all three journals
get-papers jf 2024 --force  # Force update (refresh citations)
```

### Query Journal Articles
```bash
query-papers rank-authors top3 --250              # Rank top 250 authors
query-papers rank-authors top3 --250 --citations  # Rank by citations
query-papers rank-authors jf 2024 --250           # Rank from JF 2024
query-papers make-author-list top3 --250          # Generate CSV
query-papers list-articles jf 2024                # List all articles
query-papers list-articles top3 --author="Fama"   # Search by author
```

### Working Papers
```bash
get-wp author_list.csv 2024        # Fetch working papers
get-wp author_list.csv 2024 --N 50 # Limit to first 50 authors

query-wp rank --250                # Rank authors by WPs
query-wp rank 2024 --250           # Rank for specific year
query-wp list                      # List all working papers
query-wp list 2024                 # List for specific year
query-wp list --author="Fama"      # Filter by author
query-wp list --N 50               # Limit results
```

### Research Agendas
```bash
extract-agendas 250         # Extract agendas for top 250
extract-agendas 250 --display  # Show previously saved results
```

## Database Files

All databases are stored in `out/data/`:

- `openalex_{journal}_{year}.db` - Journal articles
- `working_papers.db` or `working_papers_{year}.db` - Working papers
- `author_list_top3_*.csv` - Generated author rankings

## Tips

1. **Start with the main workflow**: `finance-papers`
   - Interactive prompts guide you through the process
   - Choose what to update (y/n)
   - Automatically displays results

2. **Use --force carefully**: Only needed when:
   - Building initial database
   - Want to refresh all citation counts
   - Need to reprocess all years

3. **Incremental mode** (default):
   - Only updates latest year (2025)
   - Fast and efficient for daily use
   - Keeps historical data intact

4. **Working papers**:
   - Fetched for top 250 authors only
   - Can limit with --N flag for testing
   - Includes institutional affiliations

5. **Research agendas**:
   - Uses OpenAI API (requires OPENAI_API_KEY env var)
   - Save results with first run
   - View later with --display flag

## Common Workflows

### Daily Update
```bash
finance-papers
# Press 'y' for journal articles
# Press 'y' for working papers
```

### Quick Check
```bash
query-papers rank-authors top3 --250
query-wp list --N 30
```

### Initial Setup
```bash
finance-papers --force
extract-agendas 250
```

### Search Specific Author
```bash
query-papers list-articles top3 --author="Cochrane"
query-wp list --author="Cochrane"
```

## Environment Variables

- `OPENAI_API_KEY` - Required for extract-agendas
- `OPENALEX_MAILTO` - Optional, for OpenAlex API politeness

## Uninstall

```bash
pip uninstall finance-papers
```
